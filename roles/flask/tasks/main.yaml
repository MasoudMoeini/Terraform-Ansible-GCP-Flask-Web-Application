---
- name: Ensure pip is at the latest version
  apt:
    name: python3-pip
    state: latest
    update_cache: yes

#- name: install modules in a virtualenv
  #  pip: #requirements: /home/{{ ansible_ssh_user }}/{{ app_name }}/requirements.txt
- name: Your copy task
  copy: src={{ item.src }} dest={{ item.dest }}
  with_items:
    - { src: 'requirements.txt', dest: '/home/masod_atc/requirements.txt' }
    - { src: 'app.py', dest: '/home/masod_atc/app.py' }
    - { src: 'main.py', dest: '/home/masod_atc/main.py' }
    - { src: 'minst.py', dest: '/home/masod_atc/minst.py' }
    - { src: 'model.h5', dest: '/home/masod_atc/model.h5' }
    - { src: 'templates/', dest: '/home/masod_atc/templates/' }

 
  #installing libraries
- name: install python libraries
  pip:
    requirements: /home/masod_atc/requirements.txt
#- name: execute flaskstroy application, run my script!
 #command: python3 ./home/masod_atc/main.py
- name: copy template systemd service config
  copy:
    src: .service
    dest: /etc/systemd/system/flask.service
- name: Start Systemd Flask App Service 
  systemd: name=flask state=started daemon_reload=yes
     

