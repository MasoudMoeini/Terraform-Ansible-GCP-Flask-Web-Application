---
- name: Ensure pip is at the latest version
  apt:
    name: python3-pip
    state: latest
    update_cache: yes
#sudo apt-get update; sudo apt-get install -yq build-essential python-pip rsync; pip install flask
# Install system apt packages
- name: install flask with pip
  pip: name=flask
- name: install numpy with pip
  pip: name=numpy
- name: install tensorflow with pip
  pip: name=tensorflow==2.9.1
- name: install pillow
  pip: name=Pillow==9.1.1
- name: copying app file with playbook
  copy:
    src: /Users/masoudmoeini/Desktop/Terraform-Ansible-GCP-FlaskWebApplication/app.py
    dest: ./home/masod_atc/app.py
- name: copying main file with playbook
  copy:
    src: /Users/masoudmoeini/Desktop/Terraform-Ansible-GCP-FlaskWebApplication/main.py
    dest: ./home/masod_atc/main.py
- name: copying  minst file with playbook
  copy:
    src: /Users/masoudmoeini/Desktop/Terraform-Ansible-GCP-FlaskWebApplication/minst.py
    dest: ./home/masod_atc/minst.py
- name: copying model file with playbook
  copy:
    src: /Users/masoudmoeini/Desktop/Terraform-Ansible-GCP-FlaskWebApplication/model.h5
    dest: ./home/masod_atc/model.h5
- name: copying template folder with playbook
  copy:
    src: /Users/masoudmoeini/Desktop/Terraform-Ansible-GCP-FlaskWebApplication/template
    dest: ./home/masod_atc/template
- name: execute flaskstroy application, run my script!
  command: python3 ./home/masod_atc/main.py

 #- name: install modules in a virtualenv
  #  pip: #requirements: /home/{{ ansible_ssh_user }}/{{ app_name }}/requirements.txt
     